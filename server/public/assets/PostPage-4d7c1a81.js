import{r as x,j as o,y as b,q as I,t as T,v as F,N as E,R as v,w,l as M,m as R,E as _,P as D,L as z,M as G}from"./index-108ef3d0.js";import{C as q,h as O}from"./PostTagSelect-cb5b3bc8.js";import{H as $}from"./Header-6aeb6c6a.js";import{f as C,a as U,d as H,p as Z,h as Q,u as V,r as J,B as K,v as W,t as y,S as X,M as Y}from"./FileUploadBody-f68dc815.js";const A={}.hasOwnProperty;function ee(e,t){const r=t||{};function n(a,...c){let s=n.invalid;const i=n.handlers;if(a&&A.call(a,e)){const d=String(a[e]);s=A.call(i,d)?i[d]:n.unknown}if(s)return s.call(this,a,...c)}return n.handlers=r.handlers||{},n.invalid=r.invalid,n.unknown=r.unknown,n}const te={}.hasOwnProperty;function B(e,t){let r=-1,n;if(t.extensions)for(;++r<t.extensions.length;)B(e,t.extensions[r]);for(n in t)if(te.call(t,n))switch(n){case"extensions":break;case"unsafe":{S(e[n],t[n]);break}case"join":{S(e[n],t[n]);break}case"handlers":{ne(e[n],t[n]);break}default:e.options[n]=t[n]}return e}function S(e,t){t&&e.push(...t)}function ne(e,t){t&&Object.assign(e,t)}const re=[ae];function ae(e,t,r,n){if(t.type==="code"&&C(t,n)&&(e.type==="list"||e.type===t.type&&C(e,n)))return!1;if("spread"in r&&typeof r.spread=="boolean")return e.type==="paragraph"&&(e.type===t.type||t.type==="definition"||t.type==="heading"&&U(t,n))?void 0:r.spread?1:0}const g=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],ce=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:g},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:g},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:g},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:g},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:g},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:g},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:g},{atBreak:!0,character:"~"}];function se(e){return e.label||!e.identifier?e.label||"":H(e.identifier)}function ie(e){if(!e._compiled){const t=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((t?"("+t+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function oe(e,t,r){const n=t.indexStack,a=e.children||[],c=[];let s=-1,i=r.before;n.push(-1);let d=t.createTracker(r);for(;++s<a.length;){const h=a[s];let l;if(n[n.length-1]=s,s+1<a.length){let u=t.handle.handlers[a[s+1].type];u&&u.peek&&(u=u.peek),l=u?u(a[s+1],e,t,{before:"",after:"",...d.current()}).charAt(0):""}else l=r.after;c.length>0&&(i==="\r"||i===`
`)&&h.type==="html"&&(c[c.length-1]=c[c.length-1].replace(/(\r?\n|\r)$/," "),i=" ",d=t.createTracker(r),d.move(c.join(""))),c.push(d.move(t.handle(h,e,t,{...d.current(),before:i,after:l}))),i=c[c.length-1].slice(-1)}return n.pop(),c.join("")}function le(e,t,r){const n=t.indexStack,a=e.children||[],c=t.createTracker(r),s=[];let i=-1;for(n.push(-1);++i<a.length;){const d=a[i];n[n.length-1]=i,s.push(c.move(t.handle(d,e,t,{before:`
`,after:`
`,...c.current()}))),d.type!=="list"&&(t.bulletLastUsed=void 0),i<a.length-1&&s.push(c.move(de(d,a[i+1],e,t)))}return n.pop(),s.join("")}function de(e,t,r,n){let a=n.join.length;for(;a--;){const c=n.join[a](e,t,r,n);if(c===!0||c===1)break;if(typeof c=="number")return`
`.repeat(1+c);if(c===!1)return`

<!---->

`}return`

`}const ue=/\r?\n|\r/g;function he(e,t){const r=[];let n=0,a=0,c;for(;c=ue.exec(e);)s(e.slice(n,c.index)),r.push(c[0]),n=c.index+c[0].length,a++;return s(e.slice(n)),r.join("");function s(i){r.push(t(i,a,!i))}}function fe(e,t,r){const n=(r.before||"")+(t||"")+(r.after||""),a=[],c=[],s={};let i=-1;for(;++i<e.unsafe.length;){const l=e.unsafe[i];if(!Z(e.stack,l))continue;const u=e.compilePattern(l);let f;for(;f=u.exec(n);){const m="before"in l||!!l.atBreak,k="after"in l,p=f.index+(m?f[1].length:0);a.includes(p)?(s[p].before&&!m&&(s[p].before=!1),s[p].after&&!k&&(s[p].after=!1)):(a.push(p),s[p]={before:m,after:k})}}a.sort(pe);let d=r.before?r.before.length:0;const h=n.length-(r.after?r.after.length:0);for(i=-1;++i<a.length;){const l=a[i];l<d||l>=h||l+1<h&&a[i+1]===l+1&&s[l].after&&!s[l+1].before&&!s[l+1].after||a[i-1]===l-1&&s[l].before&&!s[l-1].before&&!s[l-1].after||(d!==l&&c.push(L(n.slice(d,l),"\\")),d=l,/[!-/:-@[-`{-~]/.test(n.charAt(l))&&(!r.encode||!r.encode.includes(n.charAt(l)))?c.push("\\"):(c.push("&#x"+n.charCodeAt(l).toString(16).toUpperCase()+";"),d++))}return c.push(L(n.slice(d,h),r.after)),c.join("")}function pe(e,t){return e-t}function L(e,t){const r=/\\(?=[!-/:-@[-`{-~])/g,n=[],a=[],c=e+t;let s=-1,i=0,d;for(;d=r.exec(c);)n.push(d.index);for(;++s<n.length;)i!==n[s]&&a.push(e.slice(i,n[s])),a.push("\\"),i=n[s];return a.push(e.slice(i)),a.join("")}function ge(e){const t=e||{},r=t.now||{};let n=t.lineShift||0,a=r.line||1,c=r.column||1;return{move:d,current:s,shift:i};function s(){return{now:{line:a,column:c},lineShift:n}}function i(h){n+=h}function d(h){const l=h||"",u=l.split(/\r?\n|\r/g),f=u[u.length-1];return a+=u.length-1,c=u.length===1?c+f.length:1+f.length+n,l}}function me(e,t={}){const r={enter:a,indentLines:he,associationId:se,containerPhrasing:ke,containerFlow:be,createTracker:ge,compilePattern:ie,safe:we,stack:[],unsafe:[...ce],join:[...re],handlers:{...Q},options:{},indexStack:[],handle:void 0};B(r,t),r.options.tightDefinitions&&r.join.push(je),r.handle=ee("type",{invalid:xe,unknown:ve,handlers:r.handlers});let n=r.handle(e,void 0,r,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return n&&n.charCodeAt(n.length-1)!==10&&n.charCodeAt(n.length-1)!==13&&(n+=`
`),n;function a(c){return r.stack.push(c),s;function s(){r.stack.pop()}}}function xe(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function ve(e){const t=e;throw new Error("Cannot handle unknown node `"+t.type+"`")}function je(e,t){if(e.type==="definition"&&e.type===t.type)return 0}function ke(e,t){return oe(e,this,t)}function be(e,t){return le(e,this,t)}function we(e,t){return fe(this,e,t)}function Ce(e){const t=this;t.compiler=r;function r(n){return me(n,{...t.data("settings"),...e,extensions:t.data("toMarkdownExtensions")||[]})}}const ye=V().use(J).use(Ce).freeze(),Ae=()=>(e,t)=>{const r=new K;t.data.toc=Se(e,r)},Se=(e,t)=>{const r=[],n={};return W(e,"heading",a=>{Le(a,r,n,t)}),r};function Le(e,t,r,n){const a={value:y(e),depth:e.depth,data:{id:n.slug(y(e))},children:[]};if(e.depth===2)t.push(a),r[e.depth]=a;else{const c=r[e.depth-1];c&&(c.children.push(a),r[e.depth]=a)}}const N=(e,t,r)=>o.jsx("ul",{children:e.map(n=>o.jsx(Be,{node:n,activeId:t,maxDepth:r},n.data.id))}),Be=e=>{var s;const{node:t,activeId:r,maxDepth:n}=e,a={1:"text-2xl font-bold",2:"text-lg font-semibold",3:"text-base",4:"text-xs",5:"text-xs",6:"text-xs"},c=i=>{var d;i.preventDefault(),(d=document==null?void 0:document.getElementById(t.data.id))==null||d.scrollIntoView({behavior:"smooth",block:"start"})};return o.jsxs("li",{className:b({"ml-3":t.depth>2}),children:[o.jsx("a",{className:b("hover:text-primary-600",a[t.depth],{"text-primary-600":r===t.data.id}),href:`#${t.data.id}`,onClick:c,children:t.value}),t.depth<n&&((s=t.children)==null?void 0:s.length)>0&&N(t.children,r,n)]},t.data.id)},Ne=e=>{const{value:t,maxDepth:r}=e,n=x.useRef(),[a,c]=x.useState(),[s,i]=x.useState("");return x.useEffect(()=>{const d=l=>{l.forEach(u=>{u!=null&&u.isIntersecting&&i(u.target.id)})};return n.current=new IntersectionObserver(d,{rootMargin:"0% 0% -35% 0px"}),document.querySelectorAll("h2, h3, h4").forEach(l=>{var u;return(u=n.current)==null?void 0:u.observe(l)}),()=>{var l;return(l=n.current)==null?void 0:l.disconnect()}},[]),x.useEffect(()=>{const h=ye().use(Ae).processSync(t).data.toc;c(h)},[t]),!a||a.length===0?null:o.jsxs("div",{className:"flex flex-col",children:[o.jsx("div",{className:"text-foreground-primary text-xl font-semibold mb-2",children:"Table of Contents"}),o.jsx("div",{className:"text-foreground-secondary",children:a&&N(a,s,r||6)})]})};function Pe(e){const{image:t,...r}=e;return o.jsx("div",{...r,children:o.jsx("img",{className:"mb-2 h-96 w-full rounded-lg object-cover object-center",alt:"Post image",src:t})})}function Ie(e){const{id:t,image:r,name:n,readingTime:a,readingUnits:c="min",created:s,updated:i}=e;return o.jsxs("div",{className:"flex items-center",children:[o.jsx(I,{className:"mr-3",src:r,children:T(n),sx:{width:42,height:42,bgcolor:F(n)}}),o.jsxs("div",{children:[o.jsx("div",{children:o.jsx(E,{className:"text-foreground-primary font-semibold hover:underline",to:v.users.profile(t),children:n})}),o.jsxs("div",{className:"text-foreground-secondary",children:[o.jsxs("span",{children:[a," ",c," read"]})," • ",o.jsxs("span",{children:[" ",o.jsx("span",{children:w(s)})," ",i&&o.jsxs("span",{children:["(Updated ",w(i),")"]})]})]})]})]})}function Te(e){const{tags:t,...r}=e;return o.jsxs("div",{...r,children:[o.jsx("h5",{className:"text-lg font-semibold mb-3",children:"Tags"}),o.jsx("div",{className:" flex items-center gap-2",children:t.map(n=>o.jsx(q,{component:"a",sx:{fontSize:"1rem"},label:n.name,href:v.tags.slug(n.slug),clickable:!0},n.id))})]})}var j={},Fe=R;Object.defineProperty(j,"__esModule",{value:!0});var P=j.default=void 0,Ee=Fe(M()),Me=o,Re=(0,Ee.default)((0,Me.jsx)("path",{d:"M3 17.46v3.04c0 .28.22.5.5.5h3.04c.13 0 .26-.05.35-.15L17.81 9.94l-3.75-3.75L3.15 17.1c-.1.1-.15.22-.15.36zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"EditRounded");P=j.default=Re;function qe(){var m;const{postSlug:e}=_(),{data:t,isLoading:r,isError:n,error:a}=O(e);if(r)return o.jsx("div",{children:"Loading..."});if(n||!t)return o.jsx("div",{children:(m=a==null?void 0:a.response)==null?void 0:m.data.message});const{author:c,created:s,updated:i,image:d,description:h,body:l,tags:u,title:f}=t;return o.jsxs("div",{className:"grid grid-cols-[7fr_3fr] gap-x-10 items-start",children:[o.jsxs("div",{children:[o.jsx($,{value:f,action:o.jsx(D,{roles:["admin"],children:o.jsx(z,{to:v.posts.edit(t.slug),children:o.jsx(X,{children:o.jsx(P,{})})})})}),c&&o.jsx(Ie,{id:c.slug,name:c.name,readingTime:t.readingTime,readingUnits:"min",created:s,updated:i}),d&&o.jsx(Pe,{className:"mt-8",image:d}),o.jsx("p",{className:"mt-5",children:h}),o.jsx(Y,{value:l}),o.jsx(G,{className:"pt-5"}),o.jsx(Te,{className:"mt-5",tags:u})]}),o.jsx("div",{className:"sticky left-0 top-4",children:o.jsx(Ne,{value:l,maxDepth:3})})]})}export{qe as default};
